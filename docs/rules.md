# Folder Structure Rules

This document defines the folder structure conventions for maintaining a clean, organized codebase.

## Root Directory

**Keep minimal:** Only essential files that developers need immediately.

### Allowed in Root:
- `README.md` - Main project documentation
- `app.py` - Main application entry point
- `config.py` - Configuration module
- `requirements.txt` - Python dependencies
- `env.example` - Environment variable template
- Core application files (`logger.py`, `exceptions.py`, etc.)

### NOT Allowed in Root:
- Documentation files (use `docs/`)
- Migration scripts (use `docs/archive/migrations/`)
- Test data files
- Backup files
- Runtime logs (use `logs/`)
- Temporary files

## Documentation (`docs/`)

### Active Documentation (`docs/`)
- `GUIDE.md` - Complete setup, security, and deployment guide
- `rules.md` - Folder structure rules

### Archived Documentation (`docs/archive/documentation/`)
- Historical implementation notes
- Migration guides
- Testing documentation
- Old feature specifications

### Archived Files (`docs/archive/`)
- `migrations/` - Historical migration scripts
- `orphaned_files/` - Unused but preserved files

## Code Organization

### Services (`services/`)
- Business logic modules
- API clients
- Data processing services
- One service per file

### Database (`db/`)
- Models (`models.py`, `models_strategies.py`)
- Query helpers (`queries.py`, `queries_strategies.py`)
- Connection management (`database.py`)

### Utilities (`utils/`)
- Pure utility functions
- No business logic
- Reusable across modules

### Templates (`templates/`)
- Jinja2 HTML templates
- One template per route/page
- Shared layouts in `base.html`

### Static Files (`static/`)
- CSS files (if any)
- JavaScript files
- Images, favicons
- Third-party libraries

### Tests (`tests/`)
- Unit tests: `test_<module>.py`
- Integration tests: `test_<feature>_integration.py`
- Test data: Keep minimal, use fixtures

## Data Files

### Database (`data/`)
- `wallet.db` - Main database (SQLite)
- Backup files: Keep only latest 2 backups
- Format: `wallet_backup_YYYYMMDD_HHMMSS.db`

### Logs (`logs/`)
- Application logs: `*.log`
- Exchange traffic logs
- Rotating logs automatically handled

## Rules for File Placement

### When Adding New Files:

1. **Documentation** → `docs/`
   - New guides, deployment docs, feature docs

2. **Migration Scripts** → `docs/archive/migrations/`
   - Database migrations
   - One-time data transformation scripts

3. **Utility Scripts** → Root or `scripts/` (if created)
   - Standalone utility scripts
   - Development helpers

4. **Test Files** → `tests/`
   - All test files
   - Follow naming: `test_<name>.py`

5. **Templates** → `templates/`
   - All HTML templates
   - Include base template inheritance

### When Removing Files:

1. **Orphaned Code** → `docs/archive/orphaned_files/`
   - Don't delete immediately
   - Archive for reference

2. **Old Documentation** → `docs/archive/documentation/`
   - Keep historical context
   - Don't delete implementation history

3. **Backup Files** → Keep only latest 2
   - Delete older backups
   - Keep in `data/` directory

## Naming Conventions

### Files:
- Python: `snake_case.py`
- Templates: `snake_case.html`
- Documentation: `UPPERCASE.md`
- Config: `lowercase` or `snake_case`

### Directories:
- Lowercase: `services/`, `utils/`, `templates/`
- No spaces or special characters
- Use underscores for multi-word: `test_helpers/`

## Cache Directories

### Python Runtime Caches

These directories are automatically generated and should **never** be committed:

- `__pycache__/` - Python bytecode cache (auto-generated by Python)
- `.pytest_cache/` - pytest test cache (auto-generated by pytest)
- `.mypy_cache/` - mypy type checker cache (if using mypy)

**All cache directories are in `.gitignore`** - they're runtime artifacts.

### Cache Rules:

1. **Don't commit caches** - They're automatically regenerated
2. **Don't manually delete** - They'll be recreated as needed
3. **Orphaned cache files** - If you delete a `.py` file, remove its `.pyc` cache file
4. **Ignore in git** - All caches should be in `.gitignore`

### When Cache Files Become Orphaned:

If you delete a Python file (e.g., `auth.py`), also remove its cached bytecode:
```bash
# Cache file will be in the same directory's __pycache__
rm services/__pycache__/auth.cpython-*.pyc
```

These caches are harmless but can be cleaned up with:
```bash
find . -type d -name "__pycache__" -exec rm -r {} + 2>/dev/null
find . -type d -name ".pytest_cache" -exec rm -r {} + 2>/dev/null
find . -type d -name ".mypy_cache" -exec rm -r {} + 2>/dev/null
```

---

## Empty Directories

- **Remove empty directories** immediately
- Don't keep placeholder empty folders
- If structure is needed, add a `.gitkeep` file

## Cleanup Checklist

Before committing:
- [ ] No files in root that belong in subdirectories
- [ ] No empty directories
- [ ] Documentation moved to `docs/`
- [ ] Old backups removed (keep only latest 2)
- [ ] Logs in `logs/` directory
- [ ] Orphaned files archived, not deleted

## Migration Path

When restructuring:
1. Move files to correct location
2. Update all imports/references
3. Update documentation references
4. Commit changes
5. Archive old structure if needed

---

**Remember:** The goal is maintainability. If you're unsure where something belongs, ask: "Would a new developer find this easily?"

